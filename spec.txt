<unnamable-rule> ::= <universe-def> | <sonority-def>
	<universe-def> ::= (<name>) <universe-op> <name> 
		<universe-op> ::= "!" | "?"
	<sonority-def> ::= (<sonority-def> ">") <name> ">" <name>

<name-assign> ::= <name> ":" { <nameable-rule> | <group> }
	<prob-assign> ::= "#" <probability>

	<nameable-rule> ::= <sound-change> | <syllable> | <feature-vec> | <environment> | <feature-vec-str>
		<feature-vec> ::= { <feature-vec-def> | <name> | <group> } (<prob-assign>)
			<feature-vec-def> ::= "[" <feature-str> "]"
				<feature-str> ::= (<feature-str> ",") <spec>
					<spec> ::= <spec-op> <name>
						<spec-op> ::= "+" | "-"

		<feat-vec-str> ::= { <feat-vec-str-def> | <name> | <group> } (<prob-assign>)
			<feat-vec-str-def> ::= (<feat-vec-str>) <feature-vec>

		<environment> ::= { <environment-def> | <name> | <group> } (<prob-assign>)
			<environment-def> ::= <feat-vec-str> "_" <feat-vec-str>

		<sound-change> ::= { <sound-change-def> | <name> | <group> } (<prob-assign>)
			<sound-change-def> ::= <feature-vec> "/" <feature-vec> "/" <environment>
	
	<group> ::= <group-def> | <name>
		<group-def> ::= "{" { <nameable-rule-str> | <query-str> | <op-cat-str> } "}"
			<query-str> ::= (<query-str> ",") <query>
			<nameable-rule-str> ::= (<nameable-rule-str> ",") <nameable-rule>
			<op-cat-str> ::= (<op-cat-str> ",") <op-cat>

<op-cat> ::= (<op-cat> "&") <op-cat-arg> "&" <op-cat-arg>
	<op-cat-arg> ::= <name> | <query> | <group> | <feat-vec-str> | <feature-vec>

<query> ::= <generate> | <apply>
	<target> ::= <feature-vec> | <feat-vec-str> | <group> | <name>
	
	<generate> ::= <number> "@" <target>
	<apply> ::= <sound-change> "*" { <target> | <op-cat> }

<program> ::= (<program>) <statement> "."
	<statement> ::= <unnamable-rule> | <name-assign> | <query>
